<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>FRA Dungeon :: Jens Jonsson Portfolio</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="My write up for the 2013 spring FRA dungeon challenge." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/challanges_flags/fra_dungeon/" />





  
  <link rel="stylesheet" href="http://localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="http://localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="FRA Dungeon">
<meta property="og:description" content="My write up for the 2013 spring FRA dungeon challenge." />
<meta property="og:url" content="http://localhost:1313/posts/challanges_flags/fra_dungeon/" />
<meta property="og:site_name" content="Jens Jonsson Portfolio" />

  <meta property="og:image" content="http://localhost:1313/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2026-02-14 10:48:23 &#43;0100 CET" />












</head>
<body>


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="http://localhost:1313/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about/">About</a></li>
        
      
        
          <li><a href="/posts/uni_projects/">University Projects</a></li>
        
      
        
          <li><a href="/posts/challanges_flags/">Challenges and Flags</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/jonssonjens/">LinkedIn</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about/" >About</a></li>
        
      
        
          <li><a href="/posts/uni_projects/" >University Projects</a></li>
        
      
        
          <li><a href="/posts/challanges_flags/" >Challenges and Flags</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/jonssonjens/" >LinkedIn</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/challanges_flags/fra_dungeon/">FRA Dungeon</a>
  </h1>
  <div class="post-meta"><time class="post-date">2026-02-14</time></div>

  
  


  

  <div class="post-content"><div>
        <blockquote>
<p>FRA PCAP Challenge våren 2013
Det är inte nödvändigt att besvara flera frågor.</p>
<ol>
<li>Vad är flaggans absoluta position? Rita gärna en karta.</li>
<li></li>
</ol>
<ul>
<li>Vad kan man säga om mjukvaran som används?</li>
<li>Är det möjligt att säga något om utvecklaren?</li>
</ul>
<ol start="3">
<li>(BONUS) Hur säker kan man vara på att det endast finns en flagga?</li>
</ol>
</blockquote>
<p>Opening up wireshark shows alot of traffic between two hosts.
<img src="/FRA_Dungeon/DungeonWiresharkFirstOpen.png" alt="Wireshark showing traffic between two hosts">
It actually consists of several streams, 6 to be exact. This can be found using wiresharks <code>conversations</code> tool.
<img src="/FRA_Dungeon/wiresharkconversations.png" alt="Conversations found in pcap">
Now the most intersting thing is probably what is in these TCP packets.
<img src="/FRA_Dungeon/playerserverdata.png" alt="Client-Server Communication">
To me this looks like somekind of communication for a game (I knew my gamer skills would come in handy one day). You can most easily tell this is the case by looking at the <span style="color: red;">
  player
</span>

 packets in red. These packets include what looks like method requests to the <span style="color: blue;">
  server
</span>

. These request such as <code>get_pos()</code>, <code>get_health()</code> and <code>move(&quot;west&quot;)</code>. All of which is very video gamey.
It also appears that each conversation is one game played in the dungeon. Looking at the banner the player recieves it includes an instance number: <code>{'top': '\x1b[0;0H\x1b[1;34mFRA\x1b[2m Single User Dungeon v 0.2\x1b[0m\ninstance: Dungeon-1'}</code>. It also includes ansi escape codes which can be used to render color in a terminal (another indicator that this is a game).</p>
<p>So the goal is to analyze the program and also find the flag. What do we we know?</p>
<ol>
<li>It is most likely a game.</li>
<li>The player sends a packet and the server responds with the answer.</li>
<li>Ansi escape code is used to render it in the terminal.</li>
</ol>
<p>I began by creating seperate files for the <span style="color: red;">
  player
</span>

 and <span style="color: blue;">
  server
</span>

.</p>
<table>
<thead>
<tr>
<th><span style="color: red;">
  player
</span>

</th>
<th><span style="color: blue;">
  server
</span>

</th>
</tr>
</thead>
<tbody>
<tr>
<td>get_banner()</td>
<td>{&rsquo;top&rsquo;: &lsquo;\x1b[0;0H\x1b[1;34mFRA\x1b[2m Single User Dungeon v 0.2\x1b[0m\ninstance: Dungeon-1&rsquo;}</td>
</tr>
<tr>
<td>get_health()</td>
<td>{&lsquo;health&rsquo;: 100}</td>
</tr>
<tr>
<td>get_pos()</td>
<td>(20, 10)</td>
</tr>
<tr>
<td>get_render_function()</td>
<td>{&lsquo;function&rsquo;: &ldquo;def c_render_tile(ttype):\n\ttiles={&rsquo;the great flag!&rsquo;: &lsquo;\x1b[1m\x1b[47mF\x1b[0m&rsquo;, &lsquo;corridor&rsquo;: &rsquo; &lsquo;, &lsquo;wall&rsquo;: &lsquo;\x1b[42m \x1b[0m&rsquo;, &lsquo;health+100&rsquo;: &lsquo;\x1b[33m*\x1b[0m&rsquo;, &lsquo;dragon&rsquo;: &lsquo;\x1b[1m\x1b[45mD\x1b[0m&rsquo;, &lsquo;monster2&rsquo;: &lsquo;\x1b[34mM\x1b[0m&rsquo;, &lsquo;?&rsquo;: &lsquo;?&rsquo;, &lsquo;monster1&rsquo;: &lsquo;\x1b[34mm\x1b[0m&rsquo;}\n\treturn tiles[ttype]&rdquo;}</td>
</tr>
<tr>
<td>move(&ldquo;west&rdquo;)</td>
<td>ok</td>
</tr>
<tr>
<td>get_adj_tiles()</td>
<td>{&lsquo;west&rsquo;: &lsquo;health+100&rsquo;, &rsquo;east&rsquo;: &lsquo;corridor&rsquo;, &rsquo;north&rsquo;: &lsquo;corridor&rsquo;, &lsquo;south&rsquo;: &lsquo;corridor&rsquo;}</td>
</tr>
</tbody>
</table>
<p>These had to be lined up correctly for it to work in my code, if they didnt everything broke. I also did not know a good way to automate this so I had manualy copy pasted in the data and structured the data to align using linux commands (thanks chatgpt for the syntax for awk and all that magical stuff).</p>
<p>I coded my little game render in python and hardcoded the response for <code>get_render_function()</code> since it will be the same for every game instance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tiles_render <span style="color:#f92672">=</span> get_dict_format(<span style="color:#e6db74">&#34;{&#39;the great flag!&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[1m</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[47mF</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;corridor&#39;: &#39; &#39;, &#39;wall&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[42m </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;health+100&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[33m*</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;dragon&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[1m</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[45mD</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;monster2&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[34mM</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;?&#39;: &#39;?&#39;, &#39;monster1&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[34mm</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;}&#34;</span>)
</span></span></code></pre></div><p><code>get_dict_format()</code>just parses the json and returns it in a dictionary format using <code>ast.literal_eval()</code>.</p>
<p>I then initlize an empty white dungeon map.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dungeon <span style="color:#f92672">=</span> [[<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">[47m &#34;</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(dungeon_width)]<span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(dungeon_height)]
</span></span></code></pre></div><p>Then I just go through each <span style="color: red;">
  player
</span>

 move, that is for example <code>get_pos()</code> and handle it.
I parse it so I get a function name and an argument value.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> move_index <span style="color:#f92672">in</span> range(len(playerMoves)):
</span></span><span style="display:flex;"><span>    response_index <span style="color:#f92672">=</span> player_move_index
</span></span><span style="display:flex;"><span>    read_move <span style="color:#f92672">=</span> playerMoves[player_move_index]
</span></span><span style="display:flex;"><span>    func <span style="color:#f92672">=</span> read_move<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;(&#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    arg <span style="color:#f92672">=</span> read_move<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;(&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;)&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">&#39;&#34;&#39;</span>)
</span></span><span style="display:flex;"><span>    read_response <span style="color:#f92672">=</span> serverResponse[response_index]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_adj_tiles&#34;</span>:
</span></span><span style="display:flex;"><span>        get_adj_tiles(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_current_tile&#34;</span>:
</span></span><span style="display:flex;"><span>        get_current_tile(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;move&#34;</span>:
</span></span><span style="display:flex;"><span>        move(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;set_health&#34;</span>:
</span></span><span style="display:flex;"><span>        set_health(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_health&#34;</span>:
</span></span><span style="display:flex;"><span>        get_health(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_pos&#34;</span>:
</span></span><span style="display:flex;"><span>        get_pos(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_render_function&#34;</span>:
</span></span><span style="display:flex;"><span>        get_render_function()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_banner&#34;</span>:
</span></span><span style="display:flex;"><span>        get_banner(serverResponse[response_index])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Unknown function: &#34;</span> <span style="color:#f92672">+</span> func)
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    print_dungeon()
</span></span></code></pre></div><p>Most of these functions just parse the server response or updates the player position. Get and set health does nothing but just return since they dont contribute to creating the map.</p>
<p><code>print_dungeon()</code> work by keeping one version with a indicator where the player is and one without it. The one without the player is used to update the dungeon map and is then copied and a player is added to it, this way I do not have to remember what tile is supposed to be where the player was after he moved.I included a player because I like watching it move and explore the dungeon haha. Print dungeon also prints the banner which includes which instance is currently running.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_dungeon</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> current_banner
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> dungeon
</span></span><span style="display:flex;"><span>    print(current_banner)
</span></span><span style="display:flex;"><span>    dungeon_with_player <span style="color:#f92672">=</span> copy<span style="color:#f92672">.</span>deepcopy(dungeon)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">=</span> list(player_pos)
</span></span><span style="display:flex;"><span>    dungeon_with_player[pos[<span style="color:#ae81ff">0</span>]][pos[<span style="color:#ae81ff">1</span>]] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[92m●</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[0m&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> dungeon_with_player:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> row:
</span></span><span style="display:flex;"><span>            print(cell,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        print()
</span></span></code></pre></div><p>Moving is done by updating the player position.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(direction):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    player_pos <span style="color:#f92672">=</span> list(player_pos)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;north&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;south&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;west&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;east&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    player_pos <span style="color:#f92672">=</span> tuple(player_pos)
</span></span></code></pre></div><p><code>get_adj_tiles()</code>sets the adjecent tiles.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_adj_tiles</span>(tiles):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    tiles <span style="color:#f92672">=</span> get_dict_format(tiles)
</span></span><span style="display:flex;"><span>    north <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;north&#34;</span>]]
</span></span><span style="display:flex;"><span>    west <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;west&#34;</span>]]
</span></span><span style="display:flex;"><span>    south <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;south&#34;</span>]]
</span></span><span style="display:flex;"><span>    east <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;east&#34;</span>]]
</span></span><span style="display:flex;"><span>    set_tile_in_map(north,(player_pos[<span style="color:#ae81ff">0</span>],player_pos[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(west,(player_pos[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,player_pos[<span style="color:#ae81ff">1</span>])) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(south,(player_pos[<span style="color:#ae81ff">0</span>],player_pos[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(east,(player_pos[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,player_pos[<span style="color:#ae81ff">1</span>]))
</span></span></code></pre></div><p>Putting it all together you can watch players run around in the dungeon:</p>
<video autoplay muted loop playsinline 
       width="30%" 
       height="30%">
  <source src="/FRA_Dungeon/dungeon.mp4" type="video/webm">
  Your browser does not support the video tag.
</video>
<p>And the flag can be found where the player dies in instance 5:
<img src="/FRA_Dungeon/flag_location.png" alt="Flag Location"></p>
<p>So to answer the questions:</p>
<ol>
<li>
<blockquote>
<p>Where is the flag?</p>
</blockquote>
<ul>
<li>See the picture above</li>
</ul>
</li>
<li>
<blockquote>
<p>What can be said about the software used?
I am abit unsure how to answer this but I can say this:</p>
</blockquote>
<ul>
<li>The software is client/server based.</li>
<li>Cheating would be very easy as the client sets the values for the health using a <code>set_health(x)</code> call. Not only that the client is also the one deciding that the game is over by sending a <code>game_over()</code> packet.</li>
<li>Probably being played in a terminal.</li>
<li>Traffic is being recieved on port <code>443</code> on the server but wireshark does not flag it as <code>HTTPS</code>, which is strange.</li>
</ul>
<blockquote>
<p>Is it possible to say something about the developer?</p>
</blockquote>
<ul>
<li>I will be honest and say that I do not know.</li>
<li>Perhaps a beginner developer given how easy it is too cheat aswell as the unusual choice of port with traffic that does not seem to use <code>HTTPS</code>.</li>
</ul>
</li>
<li>
<blockquote>
<p>How sure can you be that there is only 1 flag?</p>
</blockquote>
<ul>
<li>You cant be! The data I used was was complete and consisted of a request from the <span style="color: red;">
  player
</span>

 and a response from the <span style="color: blue;">
  server
</span>

. These were the 5 first streams. The sixth stream however was incomplete and only contained the <span style="color: blue;">
  server
</span>

 responses. These responses did however not include a reference to a flag tile at all (except for how to render it) so the player did not</li>
</ul>
</li>
</ol>
<h1 id="full-python-code">Full python code<a href="#full-python-code" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>Yeah I know I am not the best coder in the world.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> ast
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> copy
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">print_dungeon</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> current_banner
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> dungeon
</span></span><span style="display:flex;"><span>    print(current_banner)
</span></span><span style="display:flex;"><span>    dungeon_with_player <span style="color:#f92672">=</span> copy<span style="color:#f92672">.</span>deepcopy(dungeon)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">=</span> list(player_pos)
</span></span><span style="display:flex;"><span>    dungeon_with_player[pos[<span style="color:#ae81ff">0</span>]][pos[<span style="color:#ae81ff">1</span>]] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[92m●</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[0m&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> dungeon_with_player:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> cell <span style="color:#f92672">in</span> row:
</span></span><span style="display:flex;"><span>            print(cell,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_dict_format</span>(to_parse):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ast<span style="color:#f92672">.</span>literal_eval(to_parse)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_banner</span>(banner):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> current_banner
</span></span><span style="display:flex;"><span>    current_banner <span style="color:#f92672">=</span> get_dict_format(banner)[<span style="color:#e6db74">&#34;top&#34;</span>]
</span></span><span style="display:flex;"><span>    print(current_banner)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_adj_tiles</span>(tiles):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    tiles <span style="color:#f92672">=</span> get_dict_format(tiles)
</span></span><span style="display:flex;"><span>    north <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;north&#34;</span>]]
</span></span><span style="display:flex;"><span>    west <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;west&#34;</span>]]
</span></span><span style="display:flex;"><span>    south <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;south&#34;</span>]]
</span></span><span style="display:flex;"><span>    east <span style="color:#f92672">=</span> tiles_render[tiles[<span style="color:#e6db74">&#34;east&#34;</span>]]
</span></span><span style="display:flex;"><span>    set_tile_in_map(north,(player_pos[<span style="color:#ae81ff">0</span>],player_pos[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(west,(player_pos[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,player_pos[<span style="color:#ae81ff">1</span>])) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(south,(player_pos[<span style="color:#ae81ff">0</span>],player_pos[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)) 
</span></span><span style="display:flex;"><span>    set_tile_in_map(east,(player_pos[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,player_pos[<span style="color:#ae81ff">1</span>]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_tile_in_map</span>(tile_type,pos):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(f&#34;setting pos: {pos[0]},{pos[1]}&#34;)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> dungeon
</span></span><span style="display:flex;"><span>    dungeon[pos[<span style="color:#ae81ff">0</span>]][pos[<span style="color:#ae81ff">1</span>]] <span style="color:#f92672">=</span> tile_type
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_current_tile</span>(response):
</span></span><span style="display:flex;"><span>    tile <span style="color:#f92672">=</span> get_dict_format(response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    set_tile_in_map(tiles_render[tile[<span style="color:#e6db74">&#34;current&#34;</span>]],player_pos)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_health</span>(response):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_pos</span>(response):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    pos <span style="color:#f92672">=</span> ast<span style="color:#f92672">.</span>literal_eval(response)
</span></span><span style="display:flex;"><span>    player_pos <span style="color:#f92672">=</span> pos
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(player_pos)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_render_function</span>():
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(direction):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> player_pos
</span></span><span style="display:flex;"><span>    player_pos <span style="color:#f92672">=</span> list(player_pos)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;north&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;south&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;west&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;east&#34;</span>:
</span></span><span style="display:flex;"><span>        player_pos[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    player_pos <span style="color:#f92672">=</span> tuple(player_pos)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_health</span>(health):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gameover</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Please provide player and server action files&#34;</span>)
</span></span><span style="display:flex;"><span>    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>player <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>player_pos <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>player_health <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>current_banner <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Always the same no need to parse</span>
</span></span><span style="display:flex;"><span>tiles_render <span style="color:#f92672">=</span> get_dict_format(<span style="color:#e6db74">&#34;{&#39;the great flag!&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[1m</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[47mF</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;corridor&#39;: &#39; &#39;, &#39;wall&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[42m </span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;health+100&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[33m*</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;dragon&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[1m</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[45mD</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;monster2&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[34mM</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;, &#39;?&#39;: &#39;?&#39;, &#39;monster1&#39;: &#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[34mm</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x1b[0m&#39;}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(player,<span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> p:
</span></span><span style="display:flex;"><span>    playerMoves <span style="color:#f92672">=</span> [move<span style="color:#f92672">.</span>strip() <span style="color:#66d9ef">for</span> move <span style="color:#f92672">in</span> p<span style="color:#f92672">.</span>readlines() <span style="color:#66d9ef">if</span> move<span style="color:#f92672">.</span>strip()]
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(server, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> s:
</span></span><span style="display:flex;"><span>    serverResponse <span style="color:#f92672">=</span> [response<span style="color:#f92672">.</span>strip() <span style="color:#66d9ef">for</span> response <span style="color:#f92672">in</span> s<span style="color:#f92672">.</span>readlines() <span style="color:#66d9ef">if</span> response<span style="color:#f92672">.</span>strip()]
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dungeon_height <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>dungeon_width <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Initilize dungeon</span>
</span></span><span style="display:flex;"><span>dungeon <span style="color:#f92672">=</span> [[<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">[47m </span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">[0m&#34;</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(dungeon_width)]<span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(dungeon_height)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> move_index <span style="color:#f92672">in</span> range(len(playerMoves)):
</span></span><span style="display:flex;"><span>    response_index <span style="color:#f92672">=</span> move_index
</span></span><span style="display:flex;"><span>    read_move <span style="color:#f92672">=</span> playerMoves[move_index]
</span></span><span style="display:flex;"><span>    func <span style="color:#f92672">=</span> read_move<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;(&#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    arg <span style="color:#f92672">=</span> read_move<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;(&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;)&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">&#39;&#34;&#39;</span>)
</span></span><span style="display:flex;"><span>    read_response <span style="color:#f92672">=</span> serverResponse[response_index]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_adj_tiles&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_adj_tiles(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_current_tile&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_current_tile(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;move&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        move(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;set_health&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        set_health(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_health&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_health(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_pos&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_pos(read_response)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_render_function&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_render_function()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> func <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;get_banner&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;called: &#34; + func + &#34;, response: &#34; + serverResponse[response_index])</span>
</span></span><span style="display:flex;"><span>        get_banner(serverResponse[response_index])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Unknown function: &#34;</span> <span style="color:#f92672">+</span> func)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.02</span>)
</span></span><span style="display:flex;"><span>    print_dungeon()
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h"></span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
    
    
      <a href="http://localhost:1313/posts/challanges_flags/investigativereversing0/" class="button inline next">
         [<span class="button__text">Investigative Reversing 0</span>] &gt;
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2026 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
